# 这是一份关于[Sync Channel Bot](https://t.me/sc_1006_bot)的说明文档

## 导航
[Bot简介](#bot简介) / [使用须知](#使用须知) / [Bot功能](#bot功能) / [关于使用Bot](#关于使用bot) / [补充](#补充) / [关于bot命令](#关于bot命令)

## Bot简介
该Bot可以将多个频道的新发送的消息，在多个频道之间同步发送，比如Bot创建了A，B，C，，（最多10个关联）频道之间的关联，那么你再任意一个频道的新消息，都会同步转发到其他所有频道。

<a style="color:red;font-size:1.5em">目前Bot在初期开发阶段，有任何建议和Bug欢迎来交流群组反馈</a>

[Bot反馈群组](https://t.me/ggbt_1120)

## 使用须知
- 本Bot只能工作在 **频道**
- Bot必须为管理员权限（只要是管理员即可，不限定具体权限）

## Bot功能
- 将Bot添加进多个频道，并将多个频道绑定为**同步组**，同步组频道内的任意频道的新消息，都会在同步组所有频道里同步转发。
- 不完美支持媒体组转发
- **懒惰模式** （该选项对整个同步组生效，懒惰模式下，新消息默认不会转发，可在消息内添加 #FF 标签临时强制发转）
- 临时不转发，在非**懒惰模式**下，在消息内添加 #NF 标签，可临时不转发本条消息

- [ ] 计划功能：同步编辑 
- [ ] 计划功能：同步删除

## 关于使用Bot
- 将Bot添加到频道，并设置为管理员即可，（不限定具体权限）。

## 补充
- 关于媒体组转发
  - **什么是媒体组转发？**
  - 如果不做特殊处理的话，一个频道内的媒体组，会被Bot分开一条条的转发到其他频道。比如你再A频道发送了一个媒体组有6张图片，那么默认情况下，Bot会在另一个频道发送6张图片，也就是6条独立消息，这是很影响体验的。
  - **有办法解决吗？**
  - 严格来说，几乎没有，因为Bot不知道媒体组有一个媒体，也就不知道媒体组是否已经接收完整了，也就无法判断转发媒体组的时机。
  - **那你是怎么缓解问题的呢**
  - Bot识别都媒体组时，会进入捕获模式，将相同的媒体组打包在一起。接着Bot会等待到这个媒体接收时间的10秒后，每个相同媒体组的消息，都会延长这个等待时间。如果Bot等待完成后，发现不用再等待了，就会发送捕获到的媒体组。或者在等待过程中，Bot发现媒体组已经有10个媒体了，Bot将不会等待，立即转发媒体组（因为TG媒体组最多10个媒体）
  - **听起来挺好的，有什么弊端吗**
  - 如果小体积媒体（2kb）和大体积媒体（200Mb）一同打包，那么等待的10秒大概是等不到大媒体发送完成的，要么多等些时间，那到底等多久呢？万一是2Gb呢，所以没有在动态等待的时间里被捕获的媒体组，会被Bot捕获为新的另一个媒体组另行转发。
- 关于**懒惰模式**
   - 同步多个群组间的所有消息，明显不是很符合逻辑的场景。所以有这个懒惰模式，但该模式默认是关闭的。
 - 关于**频道冻结模式**
   - 被冻结的频道依旧在同步组内，只是他的新消息不会转发出去，同步组内的其他频道的消息也不会转发进来，你只需解冻即可重新加入互相同步。而如果是在同组删除了频道，同步组频道数量会减一，你只有重新将频道加入同步组才能重新同步转发。
 - Bot内部的自动逻辑
   - 如果Bot发现一个同步组的频道数量小于等于1个，Bot会删除同步组。
   - 对同步组进行冻结，其实是冻结了同步组内所有的频道
   - 删除同步组，会自动将同步组的所有频道退出同步组

## 关于bot命令
**下面命令只能在私聊Bot时使用，所有命令都未在BotFather注册，你需要手动输入**
- `/group`：对同步组操作的主命令
  - `create`：创建同步组命令，必须参数：`-cids [channelId01, channelId02, channelId03 ... ]`
    - 示例`/group create -cids 121312 123123124 124124124`
    - `-cids` 是 `--channel-ids` 的缩写，你也可以用全程来代替`-cids`，频道id必须提供2个及以上，但要小于10个。Bot必须加入了所有频道，且为所有频道管理员。你必须为所有频道的创建者。
  - `add`：将频道加入同步组，必须参数：`-cid [channelId]` `-gid [groupId]`，参数数量必须为1个
    - `cid`即为频道id，`gid`为同步组id（你可以使用`list`查看gid）
  - `list`：列出你创建的同步组，可选参数：`-gid [groupid]`, 只支持一个关联组ID
    - 当不提供关联组ID时 会列出所有你创建的关联组信息
    - 想查看特定关联组信息时，你可以提供且只能提供一个关联组id来查看
  - `delete`：删除关联组，必须参数: `-gid [groupid]`，参数数量必须为1个
    - 当你删除一个关联组时，该关联组内的所有频道都会被删除
  - `freeze`：冻结同步组，必须参数：`-gid [groupId]`， 参数数量必须为1个
    - 当你冻结一个同步组时，该同步组内的所有频道都会被冻结
  - `set`：设置同步组，必须参数：`-gid [groupId]` 可选参数：`-lz [true/false]`，`-da [true/false]`
    - `-lz` 是 `--lazy` 的缩写，设置为懒惰模式时，Bot默认不转发新消息，除非在消息内添加 #FF 标签临时强制转发
    - `-da` 是 `--drop-author` 的缩写，设置抛弃转发源时，Bot转发的消息不会携带转发源，就像是手动发送的一样
- `channel`：对频道操作的主命令
  - `delete`：使频道退出其所在的同步组，必须参数：`-cid [channelId01, channelId02]`，可以提供多个频道id
  - `freeze`: 冻结频道，必须参数：`-cid [channelId01, channelId02]`，可以提供多个频道id